- name: Display each index's node information
  hosts: 127.0.0.1
  tasks:
    - include_tasks: tasks/debug-node-index.yml
- name: Consensus provisioning
  hosts: all
  vars_files:
    - vars/common.yml
  tasks:
    - include_tasks: tasks/consensus-stop-all.yml
    - include_tasks: tasks/consensus-node-config-init.yml
    - include_tasks: tasks/consensus-ibft-init.yml
      vars:
        NodesNum: 5
    - include_tasks: tasks/consensus-ibft-start.yml
      vars:
        PrivacyImpl: tessera
- name: Add packet misorder for node-1
  hosts: aws_ec2[0]
  vars_files:
    - vars/common.yml
  tasks:
    - include_tasks: tasks/netem-clear-all.yml
    - include_tasks: tasks/netem-packet-misorder-gap.yml
      vars: 
        action: add
        packet_nodelay_index_mod_base: 5
        delay_time: 10ms
        probability: 25%
        correlation_probability: 50%
- name: Add packet misorder for node-2
  hosts: aws_ec2[1]
  vars_files:
    - vars/common.yml
  tasks:
    - include_tasks: tasks/netem-clear-all.yml
    - include_tasks: tasks/netem-packet-misorder-probability.yml
      vars:
        action: add
        delay_time: 10ms
        probability: 25%
        correlation_probability: 50%
